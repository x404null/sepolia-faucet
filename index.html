
<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Fishing Hard Days üé£</title>
<style>
body{
  font-family: monospace;
  background:#1b1b1b;
  color:#fff;
  text-align:center;
}
#game{
  background:#222;
  padding:20px;
  width:350px;
  margin:auto;
  border:3px solid #555;
  border-radius:8px;
}
button{
  padding:10px;
  margin:5px;
  background:#444;
  color:white;
  border:2px solid #666;
  cursor:pointer;
}
button:hover{background:#666;}

#powerContainer{
  width:300px;
  height:20px;
  background:#555;
  border:2px solid #999;
  margin:20px auto;
  display:none;
}
#powerBar{
  width:10px;
  height:100%;
  background:#0f0;
}

/* SHOP */
#shop{
  display:none;
  background:#111;
  padding:10px;
  margin-top:15px;
  border:2px solid #666;
}
#shop button{background:#777;border:1px solid #aaa;}
</style>
</head>

<body>

<h1>üé£ Fishing Hard Days - Retro 9x</h1>

<div id="game">
  <div id="stats">
    H·ªì: <span id="level">1</span> / 10<br>
    L∆∞·ª£t c√¢u: <span id="turns">3</span><br>
    Ti·ªÅn: <span id="coins">0</span>
  </div>

  <button id="btnCast" onclick="startCast()">üé£ B·∫Øt ƒë·∫ßu c√¢u</button>
  <button onclick="openShop()">üõí Shop</button>

  <div id="powerContainer">
    <div id="powerBar"></div>
  </div>

  <p id="result"></p>
  <button id="nextLevel" onclick="nextLevel()" style="display:none">üìç Sang h·ªì ti·∫øp theo</button>

  <!-- üõç SHOP -->
  <div id="shop">
    <h3>üõ†Ô∏è SHOP N√ÇNG C·∫§P</h3>
    <p>C·∫•p c·∫ßn c√¢u: <span id="rodLevel">1</span></p>
    <p>TƒÉng t·ªâ l·ªá th√†nh c√¥ng: +<span id="rodBonus">0</span>%</p>
    <p>Gi√° n√¢ng c·∫•p: <span id="upgradeCost">50</span>üí∞</p>
    <button onclick="upgradeRod()">‚öôÔ∏è N√¢ng c·∫•p c·∫ßn c√¢u</button><br><br>
    <button onclick="closeShop()">‚ùå ƒê√≥ng</button>
  </div>

</div>


<script>
// ---------------- BI·∫æN C∆† B·∫¢N ----------------
let turns = 3;
let coins = 0;
let level = 1;
let casting = false;
let direction = 1;
let power = 0;
let interval;

// C√° theo ƒë·ªô hi·∫øm
const fishTypes = [
  {name:"Common", price:5, baseSuccess:50},
  {name:"Rare", price:15, baseSuccess:35},
  {name:"Epic", price:40, baseSuccess:20},
  {name:"Legendary", price:100, baseSuccess:10}
];

function updateUI(){
  document.getElementById("turns").textContent = turns;
  document.getElementById("coins").textContent = coins;
  document.getElementById("level").textContent = level;
}

// ---------------- C√ÇU C√Å ----------------
function startCast(){
  if(turns <= 0) return showText("‚ùå H·∫øt l∆∞·ª£t! Ch∆°i l·∫°i sau!");

  document.getElementById("powerContainer").style.display = "block";
  document.getElementById("btnCast").style.display = "none";

  casting = true;
  power = 0;

  interval = setInterval(()=>{
    let speed = 3 + level;
    power += direction * speed;
    if(power >= 300 || power <= 0) direction *= -1;
    document.getElementById("powerBar").style.width = power+"px";
  },30);
}

document.body.onclick = stopCast;
document.body.onkeydown = (e)=>{ if(e.code==="Space") stopCast(); };

function stopCast(){
  if(!casting) return;
  casting = false;
  clearInterval(interval);
  document.getElementById("powerContainer").style.display = "none";

  turns--;
  updateUI();

  let gaugeBonus = Math.floor(power/10);

  // Random c√°
  let r = Math.random()*100;
  let fish;
  if(r < 60) fish = fishTypes[0];
  else if(r < 85) fish = fishTypes[1];
  else if(r < 95) fish = fishTypes[2];
  else fish = fishTypes[3];

  // T√≠nh t·ªâ l·ªá
  let successRate = fish.baseSuccess - (level*4) + gaugeBonus + rodBonus;
  if(successRate < 5) successRate = 5;
  if(successRate > 95) successRate = 95;

  let caught = Math.random()*100 < successRate;
  if(caught){
    coins += fish.price;
    showText(`üéâ B·∫Øt ƒë∆∞·ª£c ${fish.name} +${fish.price} üí∞ (t·ªâ l·ªá ${successRate}%)`);
  }else{
    showText(`üí® S·ªïng m·∫•t! (${fish.name}) (t·ªâ l·ªá ${successRate}%)`);
  }

  document.getElementById("btnCast").style.display = "block";

  if(turns <= 0 && level < 10){
    document.getElementById("nextLevel").style.display = "block";
    showText("üìç H·∫øt l∆∞·ª£t! Sang h·ªì m·ªõi ƒë·ªÉ ti·∫øp t·ª•c.");
  }
}

// ---------------- N√ÇNG C·∫§P SHOP ----------------
let rodLevel = 1;
let rodBonus = 0;
let upgradeCost = 50;

function openShop(){
  document.getElementById("shop").style.display = "block";
  renderShop();
}
function closeShop(){
  document.getElementById("shop").style.display = "none";
}
function renderShop(){
  document.getElementById("rodLevel").textContent = rodLevel;
  document.getElementById("rodBonus").textContent = rodBonus;
  document.getElementById("upgradeCost").textContent = upgradeCost;
}
function upgradeRod(){
  if(coins < upgradeCost) return showText("‚ùå Kh√¥ng ƒë·ªß ti·ªÅn!");
  coins -= upgradeCost;
  rodLevel++;
  rodBonus += 5;
  upgradeCost = Math.floor(upgradeCost * 2);

  updateUI();
  renderShop();
  showText(`‚öôÔ∏è N√¢ng c·∫•p xong! C·∫ßn c√¢u c·∫•p ${rodLevel} (+${rodBonus}%)`);
}

// ---------------- LEVEL MAP ----------------
function nextLevel(){
  if(level >= 10) return showText("üèÜ B·∫°n ƒë√£ qua 10 h·ªì. H·∫øt map!");
  level++;
  turns = 3;
  document.getElementById("nextLevel").style.display = "none";
  showText(`‚û°Ô∏è Sang h·ªì c·∫•p ${level}!`);
  updateUI();
}

// ---------------- HI·ªÇN TH·ªä ----------------
function showText(msg){
  document.getElementById("result").textContent = msg;
}

updateUI();
</script>
</body>
</html>
